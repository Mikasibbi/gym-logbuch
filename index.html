<!DOCTYPE html>
<html lang="de">
<head>
<link href="gym-logbuch.css?v=1.0.3" type="text/css" rel="stylesheet">
<meta charset="UTF-8">
<title>Gym Logbuch</title>

<style>
body {
    font-family: Arial, sans-serif;
    margin: 30px;
}

h2 {
    margin-top: 50px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
}

th, td {
    border: 1px solid black;
    padding: 6px;
    text-align: center;
}

th {
    background-color: #f2f2f2;
}

input {
    width: 90%;
    border: none;
    text-align: center;
}

.header-info {
    margin-bottom: 20px;
}
</style>

</head>
<body>

<h1>Workout Logbuch</h1>

<div id="pauseMessage" style="
    display: none;
    text-align: center;
    margin-top: 100px;
    font-size: 2em;
    font-weight: bold;
    color: #ff4d4d;
">
    Heute ist Restday
</div>

<!-- PUSH FB -->
<h2>PushFB</h2>

<table>
<tr>
    <th rowspan="2">Übung</th>
    <th colspan="2">Aufwärmsatz</th>
    <th colspan="2">Arbeitssatz 1</th>
    <th colspan="2">Arbeitssatz 2</th>
</tr>
<tr>
    <th>Gewicht</th>
    <th>Wdh</th>
    <th>Gewicht</th>
    <th>Wdh</th>
    <th>Gewicht</th>
    <th>Wdh</th>
</tr>

<!-- 6 Übungszeilen -->
<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>


</table>


<!-- PULL FB -->
<h2>PullFB</h2>

<table>
<tr>
    <th rowspan="2">Übung</th>
    <th colspan="2">Aufwärmsatz</th>
    <th colspan="2">Arbeitssatz 1</th>
    <th colspan="2">Arbeitssatz 2</th>
</tr>
<tr>
    <th>Gewicht</th>
    <th>Wdh</th>
    <th>Gewicht</th>
    <th>Wdh</th>
    <th>Gewicht</th>
    <th>Wdh</th>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

<tr>
    <td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
    <td><input></td><td><input></td>
</tr>

</table>
<button onclick="saveWorkout()">Training speichern</button>

<h2>Gespeicherte Trainings-Tage</h2>
<div id="history"></div>

<script src="script.js?=1.0">
function saveWorkout() {

let today = new Date();
let formattedDate = today.getDate().toString().padStart(2,'0') + '.' + 
                    (today.getMonth() + 1).toString().padStart(2,'0') + '.' +
                    today.getFullYear();

let workout = {
    date: formattedDate,
    push: [],
    pull: []
};


    // PUSH Tabelle auslesen
    let pushRows = document.querySelectorAll("h2 + table tr");
    pushRows.forEach((row, index) => {
        if(index > 1) { // Header überspringen
            let inputs = row.querySelectorAll("input");
            if(inputs.length > 0) {
                workout.push.push([
                    inputs[0].value,
                    inputs[1].value,
                    inputs[2].value,
                    inputs[3].value,
                    inputs[4].value,
                    inputs[5].value,
                    inputs[6].value
                ]);
            }
        }
    });

    // PULL Tabelle auslesen
    let pullTable = document.querySelectorAll("h2")[1].nextElementSibling;
    let pullRows = pullTable.querySelectorAll("tr");

    pullRows.forEach((row, index) => {
        if(index > 1) {
            let inputs = row.querySelectorAll("input");
            if(inputs.length > 0) {
                workout.pull.push([
                    inputs[0].value,
                    inputs[1].value,
                    inputs[2].value,
                    inputs[3].value,
                    inputs[4].value,
                    inputs[5].value,
                    inputs[6].value
                ]);
            }
        }
    });

    let history = JSON.parse(localStorage.getItem("workouts")) || [];
    history.push(workout);
    localStorage.setItem("workouts", JSON.stringify(history));

    displayHistory();
}

function loadLastWorkout() {

    let history = JSON.parse(localStorage.getItem("workouts")) || [];

    if(history.length === 0) return;

    let lastWorkout = history[history.length - 1];

    // PUSH Tabelle befüllen
    let pushRows = document.querySelectorAll("h2 + table tr");

    pushRows.forEach((row, index) => {
        if(index > 1 && lastWorkout.push[index - 2]) {
            let inputs = row.querySelectorAll("input");
            lastWorkout.push[index - 2].forEach((value, i) => {
                inputs[i].value = value;
            });
        }
    });

    // PULL Tabelle befüllen
    let pullTable = document.querySelectorAll("h2")[1].nextElementSibling;
    let pullRows = pullTable.querySelectorAll("tr");

    pullRows.forEach((row, index) => {
        if(index > 1 && lastWorkout.pull[index - 2]) {
            let inputs = row.querySelectorAll("input");
            lastWorkout.pull[index - 2].forEach((value, i) => {
                inputs[i].value = value;
            });
        }
    });
}


function displayHistory() {

    let history = JSON.parse(localStorage.getItem("workouts")) || [];
    let container = document.getElementById("history");
    container.innerHTML = "";

    history.slice().reverse().forEach((workout) => {

        let wrapper = document.createElement("div");
        wrapper.style.border = "1px solid black";
        wrapper.style.marginBottom = "15px";
        wrapper.style.padding = "10px";

        let header = document.createElement("div");
        header.style.cursor = "pointer";
        header.style.fontWeight = "bold";
        header.innerText = workout.date + " ▼";

        let content = document.createElement("div");
        content.style.display = "none";
        content.style.marginTop = "10px";

        // PUSH
        content.innerHTML += "<h4>PushFB</h4>";

        workout.push.forEach(row => {
            if(row[0] !== "") {
                content.innerHTML += `
                    <div style="margin-bottom:8px;">
                        <strong>${row[0]}</strong><br>
                        Aufwärm: ${row[1]}kg × ${row[2]}<br>
                        Satz 1: ${row[3]}kg × ${row[4]}<br>
                        Satz 2: ${row[5]}kg × ${row[6]}
                    </div>
                `;
            }
        });

        // PULL
        content.innerHTML += "<h4>PullFB</h4>";

        workout.pull.forEach(row => {
            if(row[0] !== "") {
                content.innerHTML += `
                    <div style="margin-bottom:8px;">
                        <strong>${row[0]}</strong><br>
                        Aufwärm: ${row[1]}kg × ${row[2]}<br>
                        Satz 1: ${row[3]}kg × ${row[4]}<br>
                        Satz 2: ${row[5]}kg × ${row[6]}
                    </div>
                `;
            }
        });

        header.onclick = function() {
            content.style.display = content.style.display === "none" ? "block" : "none";
        };

        wrapper.appendChild(header);
        wrapper.appendChild(content);
        container.appendChild(wrapper);
    });
}



displayHistory();
loadLastWorkout();

function showTodayWorkout() {

    // Startdatum einstellen (lokale Zeit)
    let startDate = new Date(2026, 1, 16); // Februar = 1, Tag = 16

    let today = new Date();

    // Uhrzeit auf 0 setzen, um Zeitzonenprobleme zu vermeiden
    startDate.setHours(0,0,0,0);
    today.setHours(0,0,0,0);

    let diffTime = today.getTime() - startDate.getTime();
    let diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));

    let cycleDay = diffDays % 3;

    // Push/Pull Überschriften & Tabellen
    let pushHeader = document.querySelector("h2:nth-of-type(1)");
    let pushTable = pushHeader.nextElementSibling;
    let pullHeader = document.querySelector("h2:nth-of-type(2)");
    let pullTable = pullHeader.nextElementSibling;

    // Pause-Meldung
    let pauseMessage = document.getElementById("pauseMessage");

    // Immer zuerst verstecken
    pushHeader.style.display = "none";
    pushTable.style.display = "none";
    pullHeader.style.display = "none";
    pullTable.style.display = "none";
    pauseMessage.style.display = "none";

    if(cycleDay === 0){
        // Push Tag
        pushHeader.style.display = "block";
        pushTable.style.display = "table";
    } 
    else if(cycleDay === 1){
        // Pull Tag
        pullHeader.style.display = "block";
        pullTable.style.display = "table";
    } 
    else{
        // Pause Tag
        pauseMessage.style.display = "block";
    }
}

showTodayWorkout();

</script>

</body>
</html>
